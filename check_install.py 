#!/usr/bin/env python3
import importlib.util
import subprocess
import sys

def check_package(package_name):
    try:
        spec = importlib.util.find_spec(package_name)
        if spec is None:
            return False
        return True
    except ImportError:
        return False

print("ğŸ” æ£€æŸ¥å®‰è£…çŠ¶æ€...")

packages = ["ollama", "chromadb", "PyPDF2"]
all_installed = True

for package in packages:
    if check_package(package):
        print(f"âœ… {package} å·²å®‰è£…")
    else:
        print(f"âŒ {package} æœªå®‰è£…")
        all_installed = False

# æ£€æŸ¥OllamaæœåŠ¡
try:
    result = subprocess.run(["ollama", "list"], capture_output=True, text=True, timeout=10)
    if result.returncode == 0:
        print("âœ… Ollama æœåŠ¡è¿è¡Œæ­£å¸¸")
        # æ˜¾ç¤ºå·²å®‰è£…çš„æ¨¡å‹
        if "NAME" in result.stdout:
            print("ğŸ“š å·²å®‰è£…çš„æ¨¡å‹:")
            for line in result.stdout.split('\n')[1:]:
                if line.strip():
                    print(f"   {line}")
    else:
        print("âŒ Ollama æœåŠ¡æœ‰é—®é¢˜")
        all_installed = False
except Exception as e:
    print(f"âŒ æ— æ³•è¿æ¥Ollama: {e}")
    print("è¯·è¿è¡Œ: ollama serve")

if all_installed:
    print("\nğŸ‰ æ‰€æœ‰ä¾èµ–å·²å°±ç»ªï¼å¯ä»¥è¿è¡Œæ™ºèƒ½ä½“äº†ï¼")
    print("è¿è¡Œ: python mac_agent.py")
else:
    print("\nğŸ’¡ è¯·å®‰è£…ç¼ºå¤±çš„åŒ…åé‡è¯•")